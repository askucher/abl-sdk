// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
function curry$(n,t){var e,r=function(u){return n.length>1?function(){var o=u?u.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}function bind$(n,t,e){return function(){return(e||n)[t].apply(n,arguments)}}function curry$(n,t){var e,r=function(u){return n.length>1?function(){var o=u?u.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}function bind$(n,t,e){return function(){return(e||n)[t].apply(n,arguments)}}angular.module("ablsdk",[]),angular.module("ablsdk").service("ablapi",function(n){return{timeslots:function(t){var e
return e=$.param({activity:t.activityId,dateRange:[moment(t.startTime).clone().startOf("day").startOf("month").toISOString(),moment(t.endTime).clone().startOf("day").endOf("month").endOf("day").toISOString()]}),n.get("timeslots?"+e)}}}),angular.module("ablsdk").service("browser",function(n){var t
return t=function(){var t,e,r
t=n.navigator.userAgent,e={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/msie/i}
for(r in e)if(e[r].test(n.navigator.userAgent))return r
return"unknown"},{name:t()}}),angular.module("ablsdk").service("ablcalc",function(n){var t
return t=function(n){switch(!1){case"undefined"!=typeof n:return 0
case null!==typeof n:return 0
case 0!==n.length:return 0
default:return n.reduce(function(n,t){return n+t})}},function(e){var r,u,o,a,c,i,l,f,s,d,p,m,v,h
return r=function(n){var t
return{name:n.name,quantity:null!=(t=n.count)?t:0,amount:n.amount,_id:n._id}},u=function(n,t){return t.amount-n.amount},o={attendees:null!=e?e.filter(function(n){return"aap"===n.type}).map(r).sort(u):void 0,addons:null!=e?e.filter(function(n){return"addon"===n.type}).map(r):void 0},a=function(){return t(o.attendees.map(f))+p()},c=function(n){switch(!1){case"tax"!==n.type:return a()/100*n.amount
case"fee"!==n.type:return t(o.attendees.map(function(n){return n.quantity}))*n.amount
default:return 0}},i=function(){return t(e.map(c))},l=function(n){var t,r,u
return null!=(t=null!=(r=e.filter(function(t){return"aap"===t.type&&t.name===n.name}))&&null!=(u=r[0])?u.amount:void 0)?t:0},f=function(n){return l(n)*n.quantity},s=function(n){return t(o.addons.filter(function(t){return t.name===n.name}).map(function(n){return n.amount}))},d=function(n){return s(n)*n.quantity},p=function(){return t(o.addons.map(d))},m=function(){var n,t,e
return n=a(),t=function(){switch(!1){case!(h.codes[0].amountOff<n):return h.codes[0].amountOff
default:return n}},e=function(){switch(!1){case 0!==h.codes.length:return 0
case null==h.codes[0].amountOff:return t()
case null==h.codes[0].percentOff:return n/100*h.codes[0].percentOff
default:return 0}}()},v=function(){return a()+i()-m()},h={codes:[],calc:m,remove:function(n){var t
return t=h.codes.indexOf(n),t>-1?h.codes.splice(t,1):void 0},add:function(t){var e,r
if(0!==(null!=(e=h.code)?e:"").length)return h.error="",r=function(n){var e
return e=function(){return h.codes.push(n),h.code="",""},h.error=function(){switch(!1){case!(0!==n.maxRedemptions&&n.maxRedemptions<=n.redemptions):return"This coupon has been fully redeemed."
case!(moment().diff(moment(n.redeemBy),"minutes")>0):return"This coupon is expired"
case!(n.activities.length>0&&n.activities[0]!==t):return"This coupon is not valid for this activity."
default:return e()}}()},n.get("coupon/"+h.code).success(function(n){return r(n)}).error(function(n){var t,e
return h.error=null!=(t=null!=n&&null!=(e=n.errors)?e[0]:void 0)?t:"Coupon not found"})},code:""},{coupon:h,addons:o.addons,attendees:o.attendees,totalWithoutTaxesfees:a,calcCoupon:m,calcTaxFee:c,calcTaxesFees:i,showPrice:l,calcPrice:f,showAddonPrice:s,calcAddonPrice:d,totalAddons:p,calcSubtotal:a,calcTotal:v}}})
var toString$={}.toString
angular.module("ablsdk").service("crud",function(n,t,e,r,u,o){return function(a,c){var i,l,f,s,d,p,m,v,h,g,y,w,b,O,k,A,S,x
return i=a.split("@"),a=i[0],l={loading:!1},f={localStorage:{remove:function(n){},add:function(n){},update:function(n){},fetch:function(n){}},memory:{remove:function(n){return h(n)},add:function(n,t){return Array.prototype.push.call(v,n),"function"==typeof t?t(n):void 0},update:function(n,t){return"function"==typeof t?t(n):void 0},fetch:function(){return l.loading=!1}},backend:{remove:function(t){return n["delete"](a+"/"+t._id).success(function(){return h(t)})},update:function(t,e){return n.update(a+"/"+t._id,t).success(function(n){return l.loading=!1,"function"==typeof e?e(n):void 0})},add:function(t,r){return n.create(a,t).success(function(n){return e("backend-success",n),b(n),"function"==typeof r?r(n):void 0})},fetch:function(){return n.get(p(a),v.options).success(function(n,t,e){var r,u
return v.length=0,r=function(n){var t,r
return t=e()[n],null!=t?(r=document.createElement("a"),r.href=e()[n],JSON.parse('{"'+decodeURI(r.search.substr(1,2e3)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')):void 0},v.options.total=(u=r("x-last-page-url"),null!=u?parseInt(u.page)*parseInt(u.pageSize):n.length),v.options.pageSize=(u=r("x-first-page-url"),null!=u?parseInt(u.pageSize):n.length),l.loading=!1,b(n)})}}},s=f[null!=(d=i[1])?d:"backend"],p=function(n){var t
for(t in v.urlOptions)n=n.replace(":"+t,v.urlOptions[t])
return n},m=t.$new(),m.items=[],v=m.items,l.loading=!1,h=function(n){var t
return t=v.indexOf(n),t>-1?Array.prototype.splice.call(v,t,1):void 0},g=function(n,t){return null!=n._id?y(n,t):w(n,t)},y=function(n,t){return l.loading?void 0:s.update(n,t)},w=function(n,t){return l.loading?void 0:s.add(n,t)},b=function(n){var t
return t=function(){switch(!1){case"Array"!==toString$.call(n).slice(8,-1):return n
case"Array"!==toString$.call(n[a]).slice(8,-1):return n[a]
case"Object"!==toString$.call(n).slice(8,-1):return[n]
default:return[]}}(),Array.prototype.push.apply(v,t),l.loading=!1},v.options={},v.urlOptions={},O=function(n){if(e("fetch",l.loading),!l.loading){switch(typeof n){case"Number":v.options.page=n
break
case"Object":v.urlOptions=$.extend({},"function"==typeof n.$url?n.$url({},v.options.urlOptions):void 0),delete n.$url,v.options=$.extend({},n,v.options),v.page=1}return l.loading=!0,s.fetch()}},O(c),k=function(){var n
if(!l.loading)return n=Array.prototype.splice.apply(v,arguments),n.forEach(s.remove)},A=function(n,t,e){var u,o
if(!l.loading)return u={title:"Deletion",content:"Are you that you want to delete this item?",ok:"Confirm",cancel:"Cancel"},r.show(r.confirm().title(null!=(o=null!=e?e.title:void 0)?o:u.title).content(null!=(o=null!=e?e.content:void 0)?o:u.content).ok(null!=(o=null!=e?e.ok:void 0)?o:u.ok).cancel(null!=(o=null!=e?e.cancel:void 0)?o:u.cancel).targetEvent(t)).then(function(){return s.remove(n)},function(){})},S=[],x=function(n){var t,e
return t=[],e=curry$(function(e,r){var u,o
return u=[],x(u),o=function(){var t
return t=Array.prototype[e].call(n,r),u.length=0,Array.prototype.push.apply(u,t)},t.push(o),o(),u}),n.loading=function(){return l.loading},n.toArray=function(){var t
return t=[],Array.prototype.push.apply(t,n),t},n.watch=function(e,r){var a
return a=function(){return u(function(){return t.forEach(function(n){return n()})})},null!=r?(S.push({array:r[e],func:a}),r.$watch(e,a,!0)):(S.push({array:e,func:a}),o.watch(e,a)),n},n.watch(n),["map","filter"].forEach(function(t){return n[t]=e(t)}),n.push=w,n.save=g,n.fetch=O,n.remove=A,n.splice=k,n.toArray=function(){return angular.copy(n)}},v.listen=function(n){return n.$on("$destroy",function(){var n,t,e,r,u=[]
for(n=0,e=(t=S).length;e>n;++n)r=t[n],u.push(o.unwatch(r.array,r.func))
return u}),v},x(v),v}}),angular.module("ablsdk").service("abldate",function(n){return function(t){var e,r
return e=function(n,t){var e,r
return e=bind$(moment(n),"format"),r=bind$(t,"format"),moment(e("YYYY-MM-DD HH:mm ")+r("Z"),"YYYY-MM-DD HH:mm Z")},r=function(n,e){return n.add(moment(e).tz(t).utcOffset()-n.utcOffset(),"minute")},{backendify:function(u){var o
return o=e(u,moment().tz(t)).tz(t),n("timezone",t),r(o),o.tz("UTC").format("YYYY-MM-DD\\THH:mm:ss\\Z")},frontendify:function(u){var o
return o=moment(u).tz(t),n("timezone",t),r(o,o),e(o,moment(u)).toDate()}}}})
var toString$={}.toString
angular.module("ablsdk").factory("debug",function(n){return function(t){var e
if(n)switch(toString$.call(t).slice(8,-1)){case"Function":return t()
default:return"undefined"!=typeof console&&null!==console&&null!=(e=console.log)?e.apply(console,arguments):void 0}}}),angular.module("ablsdk").service("safeApply",function(n){return function(t){var e
return e=n.$$phase,"$apply"===e||"$digest"===e?t():n.$apply(t)}}),angular.module("ablsdk").service("watcher",function(n,t,e){var r,u,o
return r=function(){return{unwatch:function(n,t){return"function"==typeof t.unwatch?t.unwatch():void 0},watch:function(t,e){var r
return r=n.$new(),r.array=t,e.unwatch=r.$watch("array",e,!0)}}},u=function(){return{unwatch:function(n,t){return Array.unobserve(n,t)},watch:function(t,e){var r,u,o
return r=function(){var t
return t=n.$new(),function(n,e){return t.array=n,t.$watch("array",e)}},(u=null!=(o=Array.observe)?o:r())(t,e)}}},e(t.name),o=function(){switch(!1){case"firefox"!==t.name:return r()
case"unknown"!==t.name:return r()
case"safari"!==t.name:return r()
default:return r()}}()}),angular.module("ablsdk",[]),angular.module("ablsdk").service("ablapi",function(n){return{timeslots:function(t){var e
return e=$.param({activity:t.activityId,dateRange:[moment(t.startTime).clone().startOf("day").startOf("month").toISOString(),moment(t.endTime).clone().startOf("day").endOf("month").endOf("day").toISOString()]}),n.get("timeslots?"+e)}}}),angular.module("ablsdk").service("browser",function(n){var t
return t=function(){var t,e,r
t=n.navigator.userAgent,e={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/msie/i}
for(r in e)if(e[r].test(n.navigator.userAgent))return r
return"unknown"},{name:t()}}),angular.module("ablsdk").service("ablcalc",function(n){var t
return t=function(n){switch(!1){case"undefined"!=typeof n:return 0
case null!==typeof n:return 0
case 0!==n.length:return 0
default:return n.reduce(function(n,t){return n+t})}},function(e){var r,u,o,a,c,i,l,f,s,d,p,m,v,h
return r=function(n){var t
return{name:n.name,quantity:null!=(t=n.count)?t:0,amount:n.amount,_id:n._id}},u=function(n,t){return t.amount-n.amount},o={attendees:null!=e?e.filter(function(n){return"aap"===n.type}).map(r).sort(u):void 0,addons:null!=e?e.filter(function(n){return"addon"===n.type}).map(r):void 0},a=function(){return t(o.attendees.map(f))+p()},c=function(n){switch(!1){case"tax"!==n.type:return a()/100*n.amount
case"fee"!==n.type:return t(o.attendees.map(function(n){return n.quantity}))*n.amount
default:return 0}},i=function(){return t(e.map(c))},l=function(n){var t,r,u
return null!=(t=null!=(r=e.filter(function(t){return"aap"===t.type&&t.name===n.name}))&&null!=(u=r[0])?u.amount:void 0)?t:0},f=function(n){return l(n)*n.quantity},s=function(n){return t(o.addons.filter(function(t){return t.name===n.name}).map(function(n){return n.amount}))},d=function(n){return s(n)*n.quantity},p=function(){return t(o.addons.map(d))},m=function(){var n,t,e
return n=a(),t=function(){switch(!1){case!(h.codes[0].amountOff<n):return h.codes[0].amountOff
default:return n}},e=function(){switch(!1){case 0!==h.codes.length:return 0
case null==h.codes[0].amountOff:return t()
case null==h.codes[0].percentOff:return n/100*h.codes[0].percentOff
default:return 0}}()},v=function(){return a()+i()-m()},h={codes:[],calc:m,remove:function(n){var t
return t=h.codes.indexOf(n),t>-1?h.codes.splice(t,1):void 0},add:function(t){var e,r
if(0!==(null!=(e=h.code)?e:"").length)return h.error="",r=function(n){var e
return e=function(){return h.codes.push(n),h.code="",""},h.error=function(){switch(!1){case!(0!==n.maxRedemptions&&n.maxRedemptions<=n.redemptions):return"This coupon has been fully redeemed."
case!(moment().diff(moment(n.redeemBy),"minutes")>0):return"This coupon is expired"
case!(n.activities.length>0&&n.activities[0]!==t):return"This coupon is not valid for this activity."
default:return e()}}()},n.get("coupon/"+h.code).success(function(n){return r(n)}).error(function(n){var t,e
return h.error=null!=(t=null!=n&&null!=(e=n.errors)?e[0]:void 0)?t:"Coupon not found"})},code:""},{coupon:h,addons:o.addons,attendees:o.attendees,totalWithoutTaxesfees:a,calcCoupon:m,calcTaxFee:c,calcTaxesFees:i,showPrice:l,calcPrice:f,showAddonPrice:s,calcAddonPrice:d,totalAddons:p,calcSubtotal:a,calcTotal:v}}})
var toString$={}.toString
angular.module("ablsdk").service("crud",function(n,t,e,r,u,o){return function(a,c){var i,l,f,s,d,p,m,v,h,g,y,w,b,O,k,A,S,x
return i=a.split("@"),a=i[0],l={loading:!1},f={localStorage:{remove:function(n){},add:function(n){},update:function(n){},fetch:function(n){}},memory:{remove:function(n){return h(n)},add:function(n,t){return Array.prototype.push.call(v,n),"function"==typeof t?t(n):void 0},update:function(n,t){return"function"==typeof t?t(n):void 0},fetch:function(){return l.loading=!1}},backend:{remove:function(t){return n["delete"](a+"/"+t._id).success(function(){return h(t)})},update:function(t,e){return n.update(a+"/"+t._id,t).success(function(n){return l.loading=!1,"function"==typeof e?e(n):void 0})},add:function(t,r){return n.create(a,t).success(function(n){return e("backend-success",n),b(n),"function"==typeof r?r(n):void 0})},fetch:function(){return n.get(p(a),v.options).success(function(n,t,e){var r,u
return v.length=0,r=function(n){var t,r
return t=e()[n],null!=t?(r=document.createElement("a"),r.href=e()[n],JSON.parse('{"'+decodeURI(r.search.substr(1,2e3)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')):void 0},v.options.total=(u=r("x-last-page-url"),null!=u?parseInt(u.page)*parseInt(u.pageSize):n.length),v.options.pageSize=(u=r("x-first-page-url"),null!=u?parseInt(u.pageSize):n.length),l.loading=!1,b(n)})}}},s=f[null!=(d=i[1])?d:"backend"],p=function(n){var t
for(t in v.urlOptions)n=n.replace(":"+t,v.urlOptions[t])
return n},m=t.$new(),m.items=[],v=m.items,l.loading=!1,h=function(n){var t
return t=v.indexOf(n),t>-1?Array.prototype.splice.call(v,t,1):void 0},g=function(n,t){return null!=n._id?y(n,t):w(n,t)},y=function(n,t){return l.loading?void 0:s.update(n,t)},w=function(n,t){return l.loading?void 0:s.add(n,t)},b=function(n){var t
return t=function(){switch(!1){case"Array"!==toString$.call(n).slice(8,-1):return n
case"Array"!==toString$.call(n[a]).slice(8,-1):return n[a]
case"Object"!==toString$.call(n).slice(8,-1):return[n]
default:return[]}}(),Array.prototype.push.apply(v,t),l.loading=!1},v.options={},v.urlOptions={},O=function(n){if(e("fetch",l.loading),!l.loading){switch(typeof n){case"Number":v.options.page=n
break
case"Object":v.urlOptions=$.extend({},"function"==typeof n.$url?n.$url({},v.options.urlOptions):void 0),delete n.$url,v.options=$.extend({},n,v.options),v.page=1}return l.loading=!0,s.fetch()}},O(c),k=function(){var n
if(!l.loading)return n=Array.prototype.splice.apply(v,arguments),n.forEach(s.remove)},A=function(n,t,e){var u,o
if(!l.loading)return u={title:"Deletion",content:"Are you that you want to delete this item?",ok:"Confirm",cancel:"Cancel"},r.show(r.confirm().title(null!=(o=null!=e?e.title:void 0)?o:u.title).content(null!=(o=null!=e?e.content:void 0)?o:u.content).ok(null!=(o=null!=e?e.ok:void 0)?o:u.ok).cancel(null!=(o=null!=e?e.cancel:void 0)?o:u.cancel).targetEvent(t)).then(function(){return s.remove(n)},function(){})},S=[],x=function(n){var t,e
return t=[],e=curry$(function(e,r){var u,o
return u=[],x(u),o=function(){var t
return t=Array.prototype[e].call(n,r),u.length=0,Array.prototype.push.apply(u,t)},t.push(o),o(),u}),n.loading=function(){return l.loading},n.toArray=function(){var t
return t=[],Array.prototype.push.apply(t,n),t},n.watch=function(e,r){var a
return a=function(){return u(function(){return t.forEach(function(n){return n()})})},null!=r?(S.push({array:r[e],func:a}),r.$watch(e,a,!0)):(S.push({array:e,func:a}),o.watch(e,a)),n},n.watch(n),["map","filter"].forEach(function(t){return n[t]=e(t)}),n.push=w,n.save=g,n.fetch=O,n.remove=A,n.splice=k,n.toArray=function(){return angular.copy(n)}},v.listen=function(n){return n.$on("$destroy",function(){var n,t,e,r,u=[]
for(n=0,e=(t=S).length;e>n;++n)r=t[n],u.push(o.unwatch(r.array,r.func))
return u}),v},x(v),v}}),angular.module("ablsdk").service("abldate",function(n){return function(t){var e,r
return e=function(n,t){var e,r
return e=bind$(moment(n),"format"),r=bind$(t,"format"),moment(e("YYYY-MM-DD HH:mm ")+r("Z"),"YYYY-MM-DD HH:mm Z")},r=function(n,e){return n.add(moment(e).tz(t).utcOffset()-n.utcOffset(),"minute")},{backendify:function(u){var o
return o=e(u,moment().tz(t)).tz(t),n("timezone",t),r(o),o.tz("UTC").format("YYYY-MM-DD\\THH:mm:ss\\Z")},frontendify:function(u){var o
return o=moment(u).tz(t),n("timezone",t),r(o,o),e(o,moment(u)).toDate()}}}})
var toString$={}.toString
angular.module("ablsdk").factory("debug",function(n){return function(t){var e
if(n)switch(toString$.call(t).slice(8,-1)){case"Function":return t()
default:return"undefined"!=typeof console&&null!==console&&null!=(e=console.log)?e.apply(console,arguments):void 0}}}),angular.module("ablsdk").service("safeApply",function(n){return function(t){var e
return e=n.$$phase,"$apply"===e||"$digest"===e?t():n.$apply(t)}}),angular.module("ablsdk").service("watcher",function(n,t,e){var r,u,o
return r=function(){return{unwatch:function(n,t){return"function"==typeof t.unwatch?t.unwatch():void 0},watch:function(t,e){var r
return r=n.$new(),r.array=t,e.unwatch=r.$watch("array",e,!0)}}},u=function(){return{unwatch:function(n,t){return Array.unobserve(n,t)},watch:function(t,e){var r,u,o
return r=function(){var t
return t=n.$new(),function(n,e){return t.array=n,t.$watch("array",e)}},(u=null!=(o=Array.observe)?o:r())(t,e)}}},e(t.name),o=function(){switch(!1){case"firefox"!==t.name:return r()
case"unknown"!==t.name:return r()
case"safari"!==t.name:return r()
default:return r()}}()})
