// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
(function(){angular.module("ablsdk",[])}).call(this),function(){angular.module("ablsdk").service("ablapi",function(n){return{timeslots:function(t){var e
return e=$.param({activity:t.activityId,dateRange:[moment(t.startTime).clone().startOf("day").startOf("month").toISOString(),moment(t.endTime).clone().startOf("day").endOf("month").endOf("day").toISOString()]}),n.get("timeslots?"+e)}}})}.call(this),function(){angular.module("ablsdk").service("browser",function(n){var t
return t=function(){var t,e,r
t=n.navigator.userAgent,e={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/msie/i}
for(r in e)if(e[r].test(n.navigator.userAgent))return r
return"unknown"},{name:t()}})}.call(this),function(){function n(n,t){var e,r=function(u){return n.length>1?function(){var o=u?u.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}var t={}.toString
angular.module("ablsdk").service("crud",function(e,r,u,o,a,c){return function(i,l){var f,s,d,p,m,h,v,y,g,w,b,O,k,A,x,S,Y,T
return f=i.split("@"),i=f[0],s={loading:!1},d={localStorage:{remove:function(n){},add:function(n){},update:function(n){},fetch:function(n){}},memory:{remove:function(n){return g(n)},add:function(n,t){return Array.prototype.push.call(y,n),"function"==typeof t?t(n):void 0},update:function(n,t){return"function"==typeof t?t(n):void 0},fetch:function(){return s.loading=!1}},backend:{remove:function(n){return e["delete"](i+"/"+n._id).success(function(){return g(n)})},update:function(n,t){return e.update(i+"/"+n._id,n).success(function(n){return s.loading=!1,"function"==typeof t?t(n):void 0})},add:function(n,t){return e.create(i,n).success(function(n){return u("backend-success",n),k(n),"function"==typeof t?t(n):void 0})},fetch:function(){return e.get(h(i),y.options).success(function(n,t,e){var r,u
return y.length=0,r=function(n){var t,r
return t=e()[n],null!=t?(r=document.createElement("a"),r.href=e()[n],JSON.parse('{"'+decodeURI(r.search.substr(1,2e3)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')):void 0},y.options.total=(u=r("x-last-page-url"),null!=u?parseInt(u.page)*parseInt(u.pageSize):n.length),y.options.pageSize=(u=r("x-first-page-url"),null!=u?parseInt(u.pageSize):n.length),s.loading=!1,k(n)})}}},p=d[null!=(m=f[1])?m:"backend"],h=function(n){var t
for(t in y.urlOptions)n=n.replace(":"+t,y.urlOptions[t])
return n},v=r.$new(),v.items=[],y=v.items,s.loading=!1,g=function(n){var t
return t=y.indexOf(n),t>-1?Array.prototype.splice.call(y,t,1):void 0},w=function(n,t){return null!=n._id?b(n,t):O(n,t)},b=function(n,t){return s.loading?void 0:p.update(n,t)},O=function(n,t){return s.loading?void 0:p.add(n,t)},k=function(n){var e
return e=function(){switch(!1){case"Array"!==t.call(n).slice(8,-1):return n
case"Array"!==t.call(n[i]).slice(8,-1):return n[i]
case"Object"!==t.call(n).slice(8,-1):return[n]
default:return[]}}(),Array.prototype.push.apply(y,e),s.loading=!1},y.options={},y.urlOptions={},A=function(n){if(u("fetch",s.loading),!s.loading){switch(typeof n){case"Number":y.options.page=n
break
case"Object":y.urlOptions=$.extend({},"function"==typeof n.$url?n.$url({},y.options.urlOptions):void 0),delete n.$url,y.options=$.extend({},n,y.options),y.page=1}return s.loading=!0,p.fetch()}},A(l),x=function(){var n
if(!s.loading)return n=Array.prototype.splice.apply(y,arguments),n.forEach(p.remove)},S=function(n,t,e){var r,u
if(!s.loading)return r={title:"Deletion",content:"Are you that you want to delete this item?",ok:"Confirm",cancel:"Cancel"},o.show(o.confirm().title(null!=(u=null!=e?e.title:void 0)?u:r.title).content(null!=(u=null!=e?e.content:void 0)?u:r.content).ok(null!=(u=null!=e?e.ok:void 0)?u:r.ok).cancel(null!=(u=null!=e?e.cancel:void 0)?u:r.cancel).targetEvent(t)).then(function(){return p.remove(n)},function(){})},Y=[],T=function(t){var e,r
return e=[],r=n(function(n,r){var u,o
return u=[],T(u),o=function(){var e
return e=Array.prototype[n].call(t,r),u.length=0,Array.prototype.push.apply(u,e)},e.push(o),o(),u}),t.loading=function(){return s.loading},t.toArray=function(){var n
return n=[],Array.prototype.push.apply(n,t),n},t.watch=function(n,r){var u
return u=function(){return a(function(){return e.forEach(function(n){return n()})})},null!=r?(Y.push({array:r[n],func:u}),r.$watch(n,u,!0)):(Y.push({array:n,func:u}),c.watch(n,u)),t},t.watch(t),["map","filter"].forEach(function(n){return t[n]=r(n)}),t.push=O,t.save=w,t.fetch=A,t.remove=S,t.splice=x,t.toArray=function(){return angular.copy(t)}},y.listen=function(n){return n.$on("$destroy",function(){var n,t,e,r,u=[]
for(n=0,e=(t=Y).length;e>n;++n)r=t[n],u.push(c.unwatch(r.array,r.func))
return u}),y},T(y),y}})}.call(this),function(){function n(n,t,e){return function(){return(e||n)[t].apply(n,arguments)}}angular.module("ablsdk").service("abldate",function(t){return function(e){var r,u
return r=function(t,e){var r,u
return r=n(moment(t),"format"),u=n(e,"format"),moment(r("YYYY-MM-DD HH:mm ")+u("Z"),"YYYY-MM-DD HH:mm Z")},u=function(n,t){return n.add(moment(t).tz(e).utcOffset()-n.utcOffset(),"minute")},{backendify:function(n){var o
return o=r(n,moment().tz(e)).tz(e),t("timezone",e),u(o),o.tz("UTC").format("YYYY-MM-DD\\THH:mm:ss\\Z")},frontendify:function(n){var o
return o=moment(n).tz(e),t("timezone",e),u(o,o),r(o,moment(n)).toDate()}}}})}.call(this),function(){angular.module("ablsdk").service("ablcalc",function(n){var t
return t=function(n){switch(!1){case"undefined"!=typeof n:return 0
case null!==typeof n:return 0
case 0!==n.length:return 0
default:return n.reduce(function(n,t){return n+t})}},function(e){var r,u,o,a,c,i,l,f,s,d,p,m,h,v
return r=function(n){var t
return{name:n.name,quantity:null!=(t=n.count)?t:0,amount:n.amount,_id:n._id}},u=function(n,t){return t.amount-n.amount},o={attendees:null!=e?e.filter(function(n){return"aap"===n.type}).map(r).sort(u):void 0,addons:null!=e?e.filter(function(n){return"addon"===n.type}).map(r):void 0},a=function(){return t(o.attendees.map(f))+p()},c=function(n){switch(!1){case"tax"!==n.type:return a()/100*n.amount
case"fee"!==n.type:return t(o.attendees.map(function(n){return n.quantity}))*n.amount
default:return 0}},i=function(){return t(e.map(c))},l=function(n){var t,r,u
return null!=(t=null!=(r=e.filter(function(t){return"aap"===t.type&&t.name===n.name}))&&null!=(u=r[0])?u.amount:void 0)?t:0},f=function(n){return l(n)*n.quantity},s=function(n){return t(o.addons.filter(function(t){return t.name===n.name}).map(function(n){return n.amount}))},d=function(n){return s(n)*n.quantity},p=function(){return t(o.addons.map(d))},m=function(){var n,t,e
return n=a(),t=function(){switch(!1){case!(v.codes[0].amountOff<n):return v.codes[0].amountOff
default:return n}},e=function(){switch(!1){case 0!==v.codes.length:return 0
case null==v.codes[0].amountOff:return t()
case null==v.codes[0].percentOff:return n/100*v.codes[0].percentOff
default:return 0}}()},h=function(){return a()+i()-m()},v={codes:[],calc:m,remove:function(n){var t
return t=v.codes.indexOf(n),t>-1?v.codes.splice(t,1):void 0},add:function(t){var e,r
if(0!==(null!=(e=v.code)?e:"").length)return v.error="",r=function(n){var e
return e=function(){return v.codes.push(n),v.code="",""},v.error=function(){switch(!1){case!(0!==n.maxRedemptions&&n.maxRedemptions<=n.redemptions):return"This coupon has been fully redeemed."
case!(moment().diff(moment(n.redeemBy),"minutes")>0):return"This coupon is expired"
case!(n.activities.length>0&&n.activities[0]!==t):return"This coupon is not valid for this activity."
default:return e()}}()},n.get("coupon/"+v.code).success(function(n){return r(n)}).error(function(n){var t,e
return v.error=null!=(t=null!=n&&null!=(e=n.errors)?e[0]:void 0)?t:"Coupon not found"})},code:""},{coupon:v,addons:o.addons,attendees:o.attendees,totalWithoutTaxesfees:a,calcCoupon:m,calcTaxFee:c,calcTaxesFees:i,showPrice:l,calcPrice:f,showAddonPrice:s,calcAddonPrice:d,totalAddons:p,calcSubtotal:a,calcTotal:h}}})}.call(this),function(){var n={}.toString
angular.module("ablsdk").factory("debug",function(t){return function(e){var r
if(t)switch(n.call(e).slice(8,-1)){case"Function":return e()
default:return"undefined"!=typeof console&&null!==console&&null!=(r=console.log)?r.apply(console,arguments):void 0}}})}.call(this),function(){angular.module("ablsdk").service("watcher",function(n,t,e){var r,u,o
return r=function(){return{unwatch:function(n,t){return"function"==typeof t.unwatch?t.unwatch():void 0},watch:function(t,e){var r
return r=n.$new(),r.array=t,e.unwatch=r.$watch("array",e,!0)}}},u=function(){return{unwatch:function(n,t){return Array.unobserve(n,t)},watch:function(t,e){var r,u,o
return r=function(){var t
return t=n.$new(),function(n,e){return t.array=n,t.$watch("array",e)}},(u=null!=(o=Array.observe)?o:r())(t,e)}}},e(t.name),o=function(){switch(!1){case"firefox"!==t.name:return r()
case"unknown"!==t.name:return r()
case"safari"!==t.name:return r()
default:return r()}}()})}.call(this),function(){angular.module("ablsdk").service("safeApply",function(n){return function(t){var e
return e=n.$$phase,"$apply"===e||"$digest"===e?t():n.$apply(t)}})}.call(this),function(){angular.module("ablsdk",[])}.call(this),function(){angular.module("ablsdk").service("ablapi",function(n){return{timeslots:function(t){var e
return e=$.param({activity:t.activityId,dateRange:[moment(t.startTime).clone().startOf("day").startOf("month").toISOString(),moment(t.endTime).clone().startOf("day").endOf("month").endOf("day").toISOString()]}),n.get("timeslots?"+e)}}})}.call(this),function(){angular.module("ablsdk").service("browser",function(n){var t
return t=function(){var t,e,r
t=n.navigator.userAgent,e={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/msie/i}
for(r in e)if(e[r].test(n.navigator.userAgent))return r
return"unknown"},{name:t()}})}.call(this),function(){function n(n,t){var e,r=function(u){return n.length>1?function(){var o=u?u.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}var t={}.toString
angular.module("ablsdk").service("crud",function(e,r,u,o,a,c){return function(i,l){var f,s,d,p,m,h,v,y,g,w,b,O,k,A,x,S,Y,T
return f=i.split("@"),i=f[0],s={loading:!1},d={localStorage:{remove:function(n){},add:function(n){},update:function(n){},fetch:function(n){}},memory:{remove:function(n){return g(n)},add:function(n,t){return Array.prototype.push.call(y,n),"function"==typeof t?t(n):void 0},update:function(n,t){return"function"==typeof t?t(n):void 0},fetch:function(){return s.loading=!1}},backend:{remove:function(n){return e["delete"](i+"/"+n._id).success(function(){return g(n)})},update:function(n,t){return e.update(i+"/"+n._id,n).success(function(n){return s.loading=!1,"function"==typeof t?t(n):void 0})},add:function(n,t){return e.create(i,n).success(function(n){return u("backend-success",n),k(n),"function"==typeof t?t(n):void 0})},fetch:function(){return e.get(h(i),y.options).success(function(n,t,e){var r,u
return y.length=0,r=function(n){var t,r
return t=e()[n],null!=t?(r=document.createElement("a"),r.href=e()[n],JSON.parse('{"'+decodeURI(r.search.substr(1,2e3)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')):void 0},y.options.total=(u=r("x-last-page-url"),null!=u?parseInt(u.page)*parseInt(u.pageSize):n.length),y.options.pageSize=(u=r("x-first-page-url"),null!=u?parseInt(u.pageSize):n.length),s.loading=!1,k(n)})}}},p=d[null!=(m=f[1])?m:"backend"],h=function(n){var t
for(t in y.urlOptions)n=n.replace(":"+t,y.urlOptions[t])
return n},v=r.$new(),v.items=[],y=v.items,s.loading=!1,g=function(n){var t
return t=y.indexOf(n),t>-1?Array.prototype.splice.call(y,t,1):void 0},w=function(n,t){return null!=n._id?b(n,t):O(n,t)},b=function(n,t){return s.loading?void 0:p.update(n,t)},O=function(n,t){return s.loading?void 0:p.add(n,t)},k=function(n){var e
return e=function(){switch(!1){case"Array"!==t.call(n).slice(8,-1):return n
case"Array"!==t.call(n[i]).slice(8,-1):return n[i]
case"Object"!==t.call(n).slice(8,-1):return[n]
default:return[]}}(),Array.prototype.push.apply(y,e),s.loading=!1},y.options={},y.urlOptions={},A=function(n){if(u("fetch",s.loading),!s.loading){switch(typeof n){case"Number":y.options.page=n
break
case"Object":y.urlOptions=$.extend({},"function"==typeof n.$url?n.$url({},y.options.urlOptions):void 0),delete n.$url,y.options=$.extend({},n,y.options),y.page=1}return s.loading=!0,p.fetch()}},A(l),x=function(){var n
if(!s.loading)return n=Array.prototype.splice.apply(y,arguments),n.forEach(p.remove)},S=function(n,t,e){var r,u
if(!s.loading)return r={title:"Deletion",content:"Are you that you want to delete this item?",ok:"Confirm",cancel:"Cancel"},o.show(o.confirm().title(null!=(u=null!=e?e.title:void 0)?u:r.title).content(null!=(u=null!=e?e.content:void 0)?u:r.content).ok(null!=(u=null!=e?e.ok:void 0)?u:r.ok).cancel(null!=(u=null!=e?e.cancel:void 0)?u:r.cancel).targetEvent(t)).then(function(){return p.remove(n)},function(){})},Y=[],T=function(t){var e,r
return e=[],r=n(function(n,r){var u,o
return u=[],T(u),o=function(){var e
return e=Array.prototype[n].call(t,r),u.length=0,Array.prototype.push.apply(u,e)},e.push(o),o(),u}),t.loading=function(){return s.loading},t.toArray=function(){var n
return n=[],Array.prototype.push.apply(n,t),n},t.watch=function(n,r){var u
return u=function(){return a(function(){return e.forEach(function(n){return n()})})},null!=r?(Y.push({array:r[n],func:u}),r.$watch(n,u,!0)):(Y.push({array:n,func:u}),c.watch(n,u)),t},t.watch(t),["map","filter"].forEach(function(n){return t[n]=r(n)}),t.push=O,t.save=w,t.fetch=A,t.remove=S,t.splice=x,t.toArray=function(){return angular.copy(t)}},y.listen=function(n){return n.$on("$destroy",function(){var n,t,e,r,u=[]
for(n=0,e=(t=Y).length;e>n;++n)r=t[n],u.push(c.unwatch(r.array,r.func))
return u}),y},T(y),y}})}.call(this),function(){function n(n,t,e){return function(){return(e||n)[t].apply(n,arguments)}}angular.module("ablsdk").service("abldate",function(t){return function(e){var r,u
return r=function(t,e){var r,u
return r=n(moment(t),"format"),u=n(e,"format"),moment(r("YYYY-MM-DD HH:mm ")+u("Z"),"YYYY-MM-DD HH:mm Z")},u=function(n,t){return n.add(moment(t).tz(e).utcOffset()-n.utcOffset(),"minute")},{backendify:function(n){var o
return o=r(n,moment().tz(e)).tz(e),t("timezone",e),u(o),o.tz("UTC").format("YYYY-MM-DD\\THH:mm:ss\\Z")},frontendify:function(n){var o
return o=moment(n).tz(e),t("timezone",e),u(o,o),r(o,moment(n)).toDate()}}}})}.call(this),function(){angular.module("ablsdk").service("ablcalc",function(n){var t
return t=function(n){switch(!1){case"undefined"!=typeof n:return 0
case null!==typeof n:return 0
case 0!==n.length:return 0
default:return n.reduce(function(n,t){return n+t})}},function(e){var r,u,o,a,c,i,l,f,s,d,p,m,h,v
return r=function(n){var t
return{name:n.name,quantity:null!=(t=n.count)?t:0,amount:n.amount,_id:n._id}},u=function(n,t){return t.amount-n.amount},o={attendees:null!=e?e.filter(function(n){return"aap"===n.type}).map(r).sort(u):void 0,addons:null!=e?e.filter(function(n){return"addon"===n.type}).map(r):void 0},a=function(){return t(o.attendees.map(f))+p()},c=function(n){switch(!1){case"tax"!==n.type:return a()/100*n.amount
case"fee"!==n.type:return t(o.attendees.map(function(n){return n.quantity}))*n.amount
default:return 0}},i=function(){return t(e.map(c))},l=function(n){var t,r,u
return null!=(t=null!=(r=e.filter(function(t){return"aap"===t.type&&t.name===n.name}))&&null!=(u=r[0])?u.amount:void 0)?t:0},f=function(n){return l(n)*n.quantity},s=function(n){return t(o.addons.filter(function(t){return t.name===n.name}).map(function(n){return n.amount}))},d=function(n){return s(n)*n.quantity},p=function(){return t(o.addons.map(d))},m=function(){var n,t,e
return n=a(),t=function(){switch(!1){case!(v.codes[0].amountOff<n):return v.codes[0].amountOff
default:return n}},e=function(){switch(!1){case 0!==v.codes.length:return 0
case null==v.codes[0].amountOff:return t()
case null==v.codes[0].percentOff:return n/100*v.codes[0].percentOff
default:return 0}}()},h=function(){return a()+i()-m()},v={codes:[],calc:m,remove:function(n){var t
return t=v.codes.indexOf(n),t>-1?v.codes.splice(t,1):void 0},add:function(t){var e,r
if(0!==(null!=(e=v.code)?e:"").length)return v.error="",r=function(n){var e
return e=function(){return v.codes.push(n),v.code="",""},v.error=function(){switch(!1){case!(0!==n.maxRedemptions&&n.maxRedemptions<=n.redemptions):return"This coupon has been fully redeemed."
case!(moment().diff(moment(n.redeemBy),"minutes")>0):return"This coupon is expired"
case!(n.activities.length>0&&n.activities[0]!==t):return"This coupon is not valid for this activity."
default:return e()}}()},n.get("coupon/"+v.code).success(function(n){return r(n)}).error(function(n){var t,e
return v.error=null!=(t=null!=n&&null!=(e=n.errors)?e[0]:void 0)?t:"Coupon not found"})},code:""},{coupon:v,addons:o.addons,attendees:o.attendees,totalWithoutTaxesfees:a,calcCoupon:m,calcTaxFee:c,calcTaxesFees:i,showPrice:l,calcPrice:f,showAddonPrice:s,calcAddonPrice:d,totalAddons:p,calcSubtotal:a,calcTotal:h}}})}.call(this),function(){var n={}.toString
angular.module("ablsdk").factory("debug",function(t){return function(e){var r
if(t)switch(n.call(e).slice(8,-1)){case"Function":return e()
default:return"undefined"!=typeof console&&null!==console&&null!=(r=console.log)?r.apply(console,arguments):void 0}}})}.call(this),function(){angular.module("ablsdk").service("watcher",function(n,t,e){var r,u,o
return r=function(){return{unwatch:function(n,t){return"function"==typeof t.unwatch?t.unwatch():void 0},watch:function(t,e){var r
return r=n.$new(),r.array=t,e.unwatch=r.$watch("array",e,!0)}}},u=function(){return{unwatch:function(n,t){return Array.unobserve(n,t)},watch:function(t,e){var r,u,o
return r=function(){var t
return t=n.$new(),function(n,e){return t.array=n,t.$watch("array",e)}},(u=null!=(o=Array.observe)?o:r())(t,e)}}},e(t.name),o=function(){switch(!1){case"firefox"!==t.name:return r()
case"unknown"!==t.name:return r()
case"safari"!==t.name:return r()
default:return r()}}()})}.call(this),function(){angular.module("ablsdk").service("safeApply",function(n){return function(t){var e
return e=n.$$phase,"$apply"===e||"$digest"===e?t():n.$apply(t)}})}.call(this)
