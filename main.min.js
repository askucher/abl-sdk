// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
// Generated by LiveScript 1.3.1
function bind$(n,t,e){return function(){return(e||n)[t].apply(n,arguments)}}function curry$(n,t){var e,r=function(a){return n.length>1?function(){var o=a?a.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}function curry$(n,t){var e,r=function(a){return n.length>1?function(){var o=a?a.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}function bind$(n,t,e){return function(){return(e||n)[t].apply(n,arguments)}}function curry$(n,t){var e,r=function(a){return n.length>1?function(){var o=a?a.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}function compose$(){var n=arguments
return function(){var t,e
for(e=n[0].apply(this,arguments),t=1;t<n.length;++t)e=n[t](e)
return e}}function bind$(n,t,e){return function(){return(e||n)[t].apply(n,arguments)}}function curry$(n,t){var e,r=function(a){return n.length>1?function(){var o=a?a.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}function curry$(n,t){var e,r=function(a){return n.length>1?function(){var o=a?a.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}function bind$(n,t,e){return function(){return(e||n)[t].apply(n,arguments)}}function curry$(n,t){var e,r=function(a){return n.length>1?function(){var o=a?a.concat():[]
return e=t?e||this:this,o.push.apply(o,arguments)<n.length&&arguments.length?r.call(e,o):n.apply(e,o)}:n}
return r()}function compose$(){var n=arguments
return function(){var t,e
for(e=n[0].apply(this,arguments),t=1;t<n.length;++t)e=n[t](e)
return e}}angular.module("ablsdk",[]),angular.module("ablsdk").service("ablapi",function(n){return{timeslots:function(t){var e
return e=$.param({activity:t.activityId,dateRange:[moment(t.startTime).clone().startOf("day").startOf("month").toISOString(),moment(t.endTime).clone().startOf("day").endOf("month").endOf("day").toISOString()]}),n.get("timeslots?"+e)}}}),angular.module("ablsdk").service("browser",function(n){var t
return t=function(){var t,e,r
t=n.navigator.userAgent,e={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/msie/i}
for(r in e)if(e[r].test(n.navigator.userAgent))return r
return"unknown"},{name:t()}}),angular.module("ablsdk").service("ablcalc",function(n,t){var e
return e=function(n){switch(!1){case"undefined"!=typeof n:return 0
case null!==typeof n:return 0
case 0!==n.length:return 0
default:return n.reduce(function(n,t){return n+t})}},function(r){var a,o,u,i,c,l,s,d,f,m,v,p,h,y
return a=function(n){var t
return{name:n.name,quantity:null!=(t=n.count)?t:0,amount:n.amount,_id:n._id}},o=function(n,t){return t.amount-n.amount},u={attendees:null!=r?r.filter(function(n){return"aap"===n.type}).map(a).sort(o):void 0,addons:null!=r?r.filter(function(n){return"addon"===n.type}).map(a):void 0},i=function(){return e(u.attendees.map(d))+v()},c=function(n){switch(!1){case"tax"!==n.type:return i()/100*n.amount
case"fee"!==n.type:return e(u.attendees.map(function(n){return n.quantity}))*n.amount
default:return 0}},l=function(){return e(r.map(c))},s=function(n){var t,e,a
return null!=(t=null!=(e=r.filter(function(t){return"aap"===t.type&&t.name===n.name}))&&null!=(a=e[0])?a.amount:void 0)?t:0},d=function(n){return s(n)*n.quantity},f=function(n){return e(u.addons.filter(function(t){return t.name===n.name}).map(function(n){return n.amount}))},m=function(n){return f(n)*n.quantity},v=function(){return e(u.addons.map(m))},p=function(){var n,t,e
return n=i(),t=function(){switch(!1){case!(y.codes[0].amountOff<n):return y.codes[0].amountOff
default:return n}},e=function(){switch(!1){case 0!==y.codes.length:return 0
case null==y.codes[0].amountOff:return t()
case null==y.codes[0].percentOff:return n/100*y.codes[0].percentOff
default:return 0}}()},h=function(){return i()+l()-p()},y={codes:[],calc:p,remove:function(n){var t
return t=y.codes.indexOf(n),t>-1?y.codes.splice(t,1):void 0},add:function(e){var r,a
if(0!==(null!=(r=y.code)?r:"").length)return y.error="",a=function(n){var r
return r=function(){return y.codes.push(n),y.code="",y.success="Coupon "+n.couponId+" added successfully",t(function(){var n
return n=y.success,delete y.success,n},3e3),""},y.error=function(){switch(!1){case!(0!==n.maxRedemptions&&n.maxRedemptions<=n.redemptions):return"This coupon has been fully redeemed."
case!(moment().diff(moment(n.redeemBy),"minutes")>0):return"This coupon is expired"
case!(n.activities.length>0&&n.activities[0]!==e):return"This coupon is not valid for this activity."
default:return r()}}()},n.get("coupon/"+y.code).success(function(n){return a(n)}).error(function(n){var t,e
return y.error=null!=(t=null!=n&&null!=(e=n.errors)?e[0]:void 0)?t:"Coupon not found"})},code:""},{coupon:y,addons:u.addons,attendees:u.attendees,totalWithoutTaxesfees:i,calcCoupon:p,calcTaxFee:c,calcTaxesFees:l,showPrice:s,calcPrice:d,showAddonPrice:f,calcAddonPrice:m,totalAddons:v,calcSubtotal:i,calcTotal:h}}}),angular.module("ablsdk").service("abldate",function(n){return function(t){var e,r
return e=function(n,t){var e,r
return e=bind$(moment(n),"format"),r=bind$(t,"format"),moment(e("YYYY-MM-DD HH:mm ")+r("Z"),"YYYY-MM-DD HH:mm Z")},r=function(n,e){return n.add(moment(e).tz(t).utcOffset()-n.utcOffset(),"minute")},{backendify:function(a){var o
return o=e(a,moment().tz(t)).tz(t),n("timezone",t),r(o),o.tz("UTC").format("YYYY-MM-DD\\THH:mm:ss\\Z")},frontendify:function(a){var o
return o=moment(a).tz(t),n("timezone",t),r(o,o),e(o,moment(a)).toDate()}}}})
var toString$={}.toString
angular.module("ablsdk").service("crud",function(n,t,e,r,a,o){return function(u,i){var c,l,s,d,f,m,v,p,h,y,g,b,D,w,S,A,M,T
return c=u.split("@"),u=c[0],l={loading:!1},s={localStorage:{remove:function(n){},add:function(n){},update:function(n){},fetch:function(n){}},memory:{remove:function(n){return h(n)},add:function(n,t){return Array.prototype.push.call(p,n),"function"==typeof t?t(n):void 0},update:function(n,t){return"function"==typeof t?t(n):void 0},fetch:function(){return l.loading=!1}},backend:{remove:function(t){return n["delete"](u+"/"+t._id).success(function(){return h(t)})},update:function(t,e){return n.update(u+"/"+t._id,t).success(function(n){return l.loading=!1,"function"==typeof e?e(n):void 0})},add:function(t,r){return n.create(u,t).success(function(n){return e("backend-success",n),D(n),"function"==typeof r?r(n):void 0})},fetch:function(){return e("fetch",m(u),p.options),n.get(m(u),{params:p.options}).success(function(n,t,e){var r,a
return p.length=0,r=function(n){var t,r
return t=e()[n],null!=t?(r=document.createElement("a"),r.href=e()[n],JSON.parse('{"'+decodeURI(r.search.substr(1,2e3)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')):void 0},p.options.total=(a=r("x-last-page-url"),null!=a?parseInt(a.page)*parseInt(a.pageSize):n.length),p.options.pageSize=(a=r("x-first-page-url"),null!=a?parseInt(a.pageSize):n.length),l.loading=!1,D(n)})}}},d=s[null!=(f=c[1])?f:"backend"],m=function(n){var t
for(t in p.urlOptions)n=n.replace(":"+t,p.urlOptions[t])
return n},v=t.$new(),v.items=[],p=v.items,l.loading=!1,h=function(n){var t
return t=p.indexOf(n),t>-1?Array.prototype.splice.call(p,t,1):void 0},y=function(n,t){return null!=n._id?g(n,t):b(n,t)},g=function(n,t){return l.loading?void 0:d.update(n,t)},b=function(n,t){return l.loading?void 0:d.add(n,t)},D=function(n){var t
return t=function(){switch(!1){case"Array"!==toString$.call(n).slice(8,-1):return n
case"Array"!==toString$.call(n[u]).slice(8,-1):return n[u]
case"Object"!==toString$.call(n).slice(8,-1):return[n]
default:return[]}}(),Array.prototype.push.apply(p,t),l.loading=!1},p.options={},p.urlOptions={},w=function(n){if(!l.loading){switch(typeof n){case"Number":p.options.page=n,e("number",p.options,n)
break
case"Object":p.urlOptions=$.extend({},"function"==typeof n.$url?n.$url({},p.options.urlOptions):void 0),delete n.$url,p.options=$.extend({},n,p.options)}return l.loading=!0,e("final-options",p.options,n),d.fetch()}},w(i),S=function(){var n
if(!l.loading)return n=Array.prototype.splice.apply(p,arguments),n.forEach(d.remove)},A=function(n,t,e){var a,o
if(!l.loading)return a={title:"Deletion",content:"Are you that you want to delete this item?",ok:"Confirm",cancel:"Cancel"},r.show(r.confirm().title(null!=(o=null!=e?e.title:void 0)?o:a.title).content(null!=(o=null!=e?e.content:void 0)?o:a.content).ok(null!=(o=null!=e?e.ok:void 0)?o:a.ok).cancel(null!=(o=null!=e?e.cancel:void 0)?o:a.cancel).targetEvent(t)).then(function(){return d.remove(n)},function(){})},M=[],T=function(n){var t,e
return t=[],e=curry$(function(e,r){var a,o
return a=[],T(a),o=function(){var t
return t=Array.prototype[e].call(n,r),a.length=0,Array.prototype.push.apply(a,t)},t.push(o),o(),a}),n.loading=function(){return l.loading},n.toArray=function(){var t
return t=[],Array.prototype.push.apply(t,n),t},n.watch=function(e,r){var u
return u=function(){return a(function(){return t.forEach(function(n){return n()})})},null!=r?(M.push({array:r[e],func:u}),r.$watch(e,u,!0)):(M.push({array:e,func:u}),o.watch(e,u)),n},n.watch(n),["map","filter"].forEach(function(t){return n[t]=e(t)}),n.push=b,n.save=y,n.fetch=w,n.remove=A,n.splice=S,n.toArray=function(){return angular.copy(n)}},p.listen=function(n){return n.$on("$destroy",function(){var n,t,e,r,a=[]
for(n=0,e=(t=M).length;e>n;++n)r=t[n],a.push(o.unwatch(r.array,r.func))
return a}),p},T(p),p}})
var toString$={}.toString
angular.module("ablsdk").factory("debug",function(n){return function(t){var e
if(n)switch(toString$.call(t).slice(8,-1)){case"Function":return t()
default:return"undefined"!=typeof console&&null!==console&&null!=(e=console.log)?e.apply(console,arguments):void 0}}}),angular.module("ablsdk").service("formula",function(n,t){var e,r
return e=function(t,e){var r,a
return r=null!=(a=null!=e?e.charges:void 0)?a:[],function(n){var t
return null!=(t=null!=n?n.amount:void 0)?t:0}(n.find(function(n){return n.type===t||n.subtype===t||n.description===t})(r))},r=function(t){var e,r,a,o,u,i,c,l
return(null!=t&&null!=(e=t.timeslots)?e.length:void 0)>0?(r=function(n){return[].concat.apply([],n)},a=function(t){var e,r
return e="Adult",n.map(function(n){return n.amount})(n.filter(function(n){return"active"===n.status})(n.filter(function(n){return n.type===e||n.subtype===e||n.description===e})(null!=(r=null!=t?t.charges:void 0)?r:[])))},o=function(t){var e
return n.map(function(n){return n.amount})(null!=(e=null!=t?t.charges:void 0)?e:[])},u=r(t.timeslots.map(a)),i=r(t.timeslots.map(o)),c=function(n){return Math.max.apply(Math,n)},l=function(){switch(!1){case!(u.length>0):return c(u)
case!(i.length>0):return c(i)
default:return 0}}()):"Non"},{getSlotPrice:function(n){return e("Adult",n)},getVisualPrice:r,getAdultPrice:function(n){var t
return e("Adult",null!=n&&null!=(t=n.timeslots)?t[0]:void 0)},getYouthPrice:function(n){var t
return e("Youth",null!=n&&null!=(t=n.timeslots)?t[0]:void 0)}}}),angular.module("ablsdk").filter("mdate",function(n){return function(n,t){return null!=n?n.format(t):null}}),angular.module("ablsdk").service("p",function(){var n
return{head:n=function(n){return n[0]},each:curry$(function(n,t){var e,r,a
for(e=0,r=t.length;r>e;++e)a=t[e],n(a)
return t}),map:curry$(function(n,t){var e,r,a,o=[]
for(e=0,r=t.length;r>e;++e)a=t[e],o.push(n(a))
return o}),filter:curry$(function(n,t){var e,r,a,o=[]
for(e=0,r=t.length;r>e;++e)a=t[e],n(a)&&o.push(a)
return o}),find:curry$(function(n,t){var e,r,a
for(e=0,r=t.length;r>e;++e)if(a=t[e],n(a))return a}),pairsToObj:function(n){var t,e,r,a={}
for(t=0,e=n.length;e>t;++t)r=n[t],a[r[0]]=r[1]
return a},objToPairs:function(n){var t,e,r=[]
for(t in n)e=n[t],r.push([t,e])
return r},values:function(n){var t,e,r=[]
for(t in n)e=n[t],r.push(e)
return r},any:curry$(function(n,t){var e,r,a
for(e=0,r=t.length;r>e;++e)if(a=t[e],n(a))return!0
return!1}),notAny:curry$(function(n,t){var e,r,a
for(e=0,r=t.length;r>e;++e)if(a=t[e],n(a))return!1
return!0}),sum:function(n){var t,e,r,a
for(t=0,e=0,r=n.length;r>e;++e)a=n[e],t+=a
return t},sort:function(n){return n.concat().sort(function(n,t){return n>t?1:t>n?-1:0})},sortWith:curry$(function(n,t){return t.concat().sort(n)}),sortBy:curry$(function(n,t){return t.concat().sort(function(t,e){return n(t)>n(e)?1:n(t)<n(e)?-1:0})}),reverse:function(n){return n.concat().reverse()}}}),angular.module("ablsdk").service("safeApply",function(n){return function(t){var e
return e=n.$$phase,"$apply"===e||"$digest"===e?t():n.$apply(t)}}),angular.module("ablsdk").service("ablslot",function(abldate,ablcalc,ablapi,formula,p,debug,$xabl){return function(activity,inputModel){var transformCharge,getDay,newDate,generateCalendar,getMonth,hackDate,merge,makeAvailable,performChooseSlot,actualEvent,isEmpty,slotsByDay,select,isFitToSlot,isNotFitToAnySlot,inPast,createMonth,startMonth,setCalendars,scroll,nextMonth,calendar,loadEvents,isDummy,isDisabledDay,selectDay,notSelected,disabledSlot,notAvailableSlot,close,chooseSlot,isActiveDay,isDisabledMonth,isActiveMonth,isCalendarUpDisabled,calendarUp,calendarDown,setup,move,createEventInstanceId,model,slots,calendars,activeSlots,x$,ref$
return transformCharge=function(n){return{_id:n._id,name:n.name,quantity:0,amount:n.amount}},getDay=function(n){var t
return null!=n?(t=null!=(null!=n?n.format:void 0)?n:moment(n),parseInt(t.format("YYYYMMDD"))):null},newDate=function(){var n
return n=moment.apply(null,arguments).tz(activity.timeZone)},generateCalendar=function(n,t){var e,r,a,o,u,i,c,l
return e=newDate(n),r=e.year(),a=e.month(),o=function(n){return newDate([r,a,n])},u=e.endOf("month").date(),i=p.map(o)(function(){var n,t,e=[]
for(n=1,t=u;t>=n;++n)e.push(n)
return e}()),c=newDate(i[0]).day(),l=p.map(function(){return null})(function(){var n,t,e=[]
for(n=1,t=c;t>=n;++n)e.push(n)
return e}()),{time:e,days:l.concat(i),headers:["Su","M","Tu","W","Th","F","Sa"]}},getMonth=function(n){return Math.ceil(getDay(n)/100)},hackDate=function(n,t){var e,r
return e=bind$(moment(n),"format"),r=bind$(t,"format"),moment(e("YYYY-MM-DD HH:mm ")+r("Z"),"YYYY-MM-DD HH:mm Z")},merge=function(n,t){var e,r
return e=null!=n?n:hackDate(n,moment()),r=null!=t?t:hackDate(t,moment()),moment([e.year(),e.month(),e.date(),r.hours(),r.minutes(),0])},makeAvailable=curry$(function(slot,arg){var available
return available=slot.available-eval([0].concat(model.calc.attendees.map(function(n){return n.quantity})).join("+"))}),performChooseSlot=function(n){var t,e,r,a,o
if(0!==n.available)return t=model.value,e=merge(t,n.startTime),model.date.start=e,r=abldate(activity.timeZone),model.date.origin=r.backendify(model.date.start).replace(/[\:-]/gi,""),model.date.end=n.endTime,model.charges=n.charges,model.calc=ablcalc(n.charges.concat(activity.charges)),model._id=n._id,model.eventId=activity.timeslots.filter(function(t){return t._id===n._id})[0].eventId,a=model.attendees,o=function(n){var t
return t=a.filter(function(t){return t.name===n.name}),{quantity:function(){switch(!1){case!(t.length>0):return t[0].quantity
case"Adult"!==n.name:return 1
default:return 0}}(),name:n.name,amount:n.amount}},model.attendees=n.charges.filter(function(n){return"aap"===n.type}).map(o),model.available=makeAvailable(n)},actualEvent=curry$(function(n,t){return getDay(t.startTime)===getDay(n)}),isEmpty=function(n){var t
return t=actualEvent(n),function(n){return 0===n.length}(p.filter(isFitToSlot(n))(slots))},slotsByDay=function(n){var t,e
return t=actualEvent(n),e=function(e){var r,a,o,u,i
return r=merge(n,e.startTime),a=e.endTime-e.startTime,o=e.events.filter(t).map(function(n){return n.available}),u=null!=(i=o[0])?i:e.maxOcc,{startTime:r,time:r.valueOf(),endTime:r.clone().add(a,"milliseconds"),charges:e.charges,price:formula.getVisualPrice({timeslots:[e]}),available:u,_id:e._id,duration:moment.duration(a).format("M[M] d[d] h[h] m[m]").replace(/((^| )0[a-z])|[ ]/gi,""),taken:e.maxOcc-u}},p.sortBy(function(n){return n.time})(p.map(e)(p.filter(isFitToSlot(n))(slots)))},select=function(n){return model.value=n,activeSlots.length=0,slotsByDay(n).forEach(function(n){return activeSlots.push(n)})},isFitToSlot=curry$(function(n,t){var e,r,a,o,u,i
return e=0===t.daysRunning.length,r=activity,a=function(){switch(!1){case!(getDay(t.startTime)!==getDay(n)&&e):return!0
case!(getDay(t.startTime)>getDay(n)&&!e):return!0
case!(getDay(t.untilTime)<getDay(n)&&!e):return!0
default:return!1}}(),o=function(n){var t,e
return t=null!=n&&"function"==typeof n.day?n.day():void 0,e=function(){switch(!1){case null!==t:return null
case 0!==t:return 6
default:return t-1}}()},u=!e&&p.notAny(function(t){return t===o(n)})(t.daysRunning),i=function(){switch(!1){case!u:return!1
case!a:return!1
default:return!0}}()}),isNotFitToAnySlot=function(n){switch(!1){case!p.notAny(function(n){return n.available>0})(slotsByDay(n)):return!0
case!p.notAny(isFitToSlot(n))(slots):return!0
default:return!1}},inPast=function(n){return getDay(n)<getDay(newDate())||n.diff(newDate(),"hours")<24},createMonth=function(n){return newDate([n.year(),n.month(),15])},startMonth=createMonth(newDate()),setCalendars=function(n,t,e){return calendars.length=0,calendars.push(n),calendars.push(t),loadEvents(e)},scroll={activeDate:function(){var n,t,e,r,a,o
return scroll.activeDate=function(){},n=calendars[0],t=function(t){return generateCalendar(n.time.clone().add(t,"month"))},e=function(e){return 0===e?n:t(e)},r=function(n){return"undefined"!=typeof e(n).days.find(function(n){return!isDisabledDay(n)})},a=function(n){return function(){var t,e,r=[]
for(t=1,e=n;e>=t;++t)r.push(t)
return r}().forEach(bind$(calendar,"down"))},o=[0,1,2,3,4,5,6].find(r),o>0?a(o):void 0}},nextMonth=function(n,t){return date.clone().add(t,"months")},calendar={first:startMonth,second:startMonth.clone().add(1,"months"),move:function(n){return calendar.first=calendar.first.clone().add(n,"month"),calendar.second=calendar.second.clone().add(n,"month"),setCalendars(generateCalendar(calendar.first),generateCalendar(calendar.second))},down:function(){return calendar.move(1)},up:function(){return calendar.move(-1)}},loadEvents=function(n){return ablapi.timeslots({startTime:calendars[0].time,endTime:calendars[1].time,activityId:activity._id}).success(function(t){var e,r,a
return e=abldate(activity.timeZone),r=compose$(e.frontendify,moment),a=function(n){return n.startTime=r(n.startTime),n.endTime=r(n.endTime),n.untilTime=r(n.untilTime),n},slots.length=0,t.timeslots.map(a).forEach(function(n){return slots.push(n)}),scroll.activeDate(),"function"==typeof n?n():void 0})},isDummy=function(n){switch(!1){case null!==n:return!0
default:return!1}},isDisabledDay=function(n){switch(!1){case!isDummy(n):return!0
case!isEmpty(n):return!0
case!inPast(n):return!0
case!isNotFitToAnySlot(n):return!0
default:return!1}},selectDay=function(n){return isDisabledDay(n)?void 0:(select(n),performChooseSlot(slots[0]))},notSelected=function(){switch(!1){case null!==model.date.start:return!0
case model.chosen!==!1:return!0
default:return!1}},disabledSlot=function(n){switch(!1){case 0!==n.available:return"This event is full"
default:return""}},notAvailableSlot=function(n){return n.available<=0},close=function(n){var t,e
return t=function(n){return 0===n.quantity&&"Adult"===n.name?n.quantity=1:void 0},e=model,e.attendees.forEach(t),e.chosen=n,e.visible=!1,"function"==typeof model.closed?model.closed(n):void 0},chooseSlot=function(n){return notAvailableSlot(n)?void 0:(performChooseSlot(n),close(!0))},isActiveDay=function(n){return getDay(n)===getDay(model.value)},isDisabledMonth=function(n){switch(!1){case!(getDay(n)<getDay(newDate())):return!0
default:return!1}},isActiveMonth=function(n){return getMonth(n)===getMonth(model.value)},isCalendarUpDisabled=function(){return getMonth(calendars[0].time)<getMonth(newDate())},calendarUp=function(){return isCalendarUpDisabled()?void 0:calendar.up()},calendarDown=function(){return calendar.down()},setup=function(){return setCalendars(generateCalendar(startMonth.clone()),generateCalendar(startMonth.clone().add(1,"month")),function(){return selectDay(model.value)})},move=function(n){return $xabl.put("bookings/move/"+n,{eventInstanceId:createEventInstanceId()})},createEventInstanceId=function(){var n
return n=abldate(activity.timeZone),model.eventId+"_"+n.backendify(model.date.start).replace(/[\:-]/gi,"")},model=null!=inputModel?inputModel:{},slots=[],calendars=[],activeSlots=[],x$=model,x$.date={start:null,end:null},x$.value=null,x$.eventId=null,x$.charges=[],x$.attendees=[],x$.addons=activity.charges.filter(function(n){return"addon"===n.type}).map(transformCharge),x$.questions=null!=(ref$=activity.questions)?ref$:[],x$.bg=activity.image,setup(),{model:model,activeSlots:activeSlots,move:move,selectDay:selectDay,calendars:calendars,createEventInstanceId:createEventInstanceId,calendarUp:calendarUp,calendarDown:calendarDown,close:close,isActiveMonth:isActiveMonth,isDisabledDay:isDisabledDay,isDisabledMonth:isDisabledMonth,isCalendarUpDisabled:isCalendarUpDisabled,isDummy:isDummy,isActiveDay:isActiveDay,notSelected:notSelected,chooseSlot:chooseSlot,notAvailableSlot:notAvailableSlot,disabledSlot:disabledSlot}}}),angular.module("ablsdk").service("watcher",function(n,t,e){var r,a,o
return r=function(){return{unwatch:function(n,t){return"function"==typeof t.unwatch?t.unwatch():void 0},watch:function(t,e){var r
return r=n.$new(),r.array=t,e.unwatch=r.$watch("array",e,!0)}}},a=function(){return{unwatch:function(n,t){return Array.unobserve(n,t)},watch:function(t,e){var r,a,o
return r=function(){var t
return t=n.$new(),function(n,e){return t.array=n,t.$watch("array",e)}},(a=null!=(o=Array.observe)?o:r())(t,e)}}},o=function(){switch(!1){case"firefox"!==t.name:return r()
case"unknown"!==t.name:return r()
case"safari"!==t.name:return r()
default:return r()}}()}),angular.module("ablsdk",[]),angular.module("ablsdk").service("ablapi",function(n){return{timeslots:function(t){var e
return e=$.param({activity:t.activityId,dateRange:[moment(t.startTime).clone().startOf("day").startOf("month").toISOString(),moment(t.endTime).clone().startOf("day").endOf("month").endOf("day").toISOString()]}),n.get("timeslots?"+e)}}}),angular.module("ablsdk").service("browser",function(n){var t
return t=function(){var t,e,r
t=n.navigator.userAgent,e={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/msie/i}
for(r in e)if(e[r].test(n.navigator.userAgent))return r
return"unknown"},{name:t()}}),angular.module("ablsdk").service("ablcalc",function(n,t){var e
return e=function(n){switch(!1){case"undefined"!=typeof n:return 0
case null!==typeof n:return 0
case 0!==n.length:return 0
default:return n.reduce(function(n,t){return n+t})}},function(r){var a,o,u,i,c,l,s,d,f,m,v,p,h,y
return a=function(n){var t
return{name:n.name,quantity:null!=(t=n.count)?t:0,amount:n.amount,_id:n._id}},o=function(n,t){return t.amount-n.amount},u={attendees:null!=r?r.filter(function(n){return"aap"===n.type}).map(a).sort(o):void 0,addons:null!=r?r.filter(function(n){return"addon"===n.type}).map(a):void 0},i=function(){return e(u.attendees.map(d))+v()},c=function(n){switch(!1){case"tax"!==n.type:return i()/100*n.amount
case"fee"!==n.type:return e(u.attendees.map(function(n){return n.quantity}))*n.amount
default:return 0}},l=function(){return e(r.map(c))},s=function(n){var t,e,a
return null!=(t=null!=(e=r.filter(function(t){return"aap"===t.type&&t.name===n.name}))&&null!=(a=e[0])?a.amount:void 0)?t:0},d=function(n){return s(n)*n.quantity},f=function(n){return e(u.addons.filter(function(t){return t.name===n.name}).map(function(n){return n.amount}))},m=function(n){return f(n)*n.quantity},v=function(){return e(u.addons.map(m))},p=function(){var n,t,e
return n=i(),t=function(){switch(!1){case!(y.codes[0].amountOff<n):return y.codes[0].amountOff
default:return n}},e=function(){switch(!1){case 0!==y.codes.length:return 0
case null==y.codes[0].amountOff:return t()
case null==y.codes[0].percentOff:return n/100*y.codes[0].percentOff
default:return 0}}()},h=function(){return i()+l()-p()},y={codes:[],calc:p,remove:function(n){var t
return t=y.codes.indexOf(n),t>-1?y.codes.splice(t,1):void 0},add:function(e){var r,a
if(0!==(null!=(r=y.code)?r:"").length)return y.error="",a=function(n){var r
return r=function(){return y.codes.push(n),y.code="",y.success="Coupon "+n.couponId+" added successfully",t(function(){var n
return n=y.success,delete y.success,n},3e3),""},y.error=function(){switch(!1){case!(0!==n.maxRedemptions&&n.maxRedemptions<=n.redemptions):return"This coupon has been fully redeemed."
case!(moment().diff(moment(n.redeemBy),"minutes")>0):return"This coupon is expired"
case!(n.activities.length>0&&n.activities[0]!==e):return"This coupon is not valid for this activity."
default:return r()}}()},n.get("coupon/"+y.code).success(function(n){return a(n)}).error(function(n){var t,e
return y.error=null!=(t=null!=n&&null!=(e=n.errors)?e[0]:void 0)?t:"Coupon not found"})},code:""},{coupon:y,addons:u.addons,attendees:u.attendees,totalWithoutTaxesfees:i,calcCoupon:p,calcTaxFee:c,calcTaxesFees:l,showPrice:s,calcPrice:d,showAddonPrice:f,calcAddonPrice:m,totalAddons:v,calcSubtotal:i,calcTotal:h}}}),angular.module("ablsdk").service("abldate",function(n){return function(t){var e,r
return e=function(n,t){var e,r
return e=bind$(moment(n),"format"),r=bind$(t,"format"),moment(e("YYYY-MM-DD HH:mm ")+r("Z"),"YYYY-MM-DD HH:mm Z")},r=function(n,e){return n.add(moment(e).tz(t).utcOffset()-n.utcOffset(),"minute")},{backendify:function(a){var o
return o=e(a,moment().tz(t)).tz(t),n("timezone",t),r(o),o.tz("UTC").format("YYYY-MM-DD\\THH:mm:ss\\Z")},frontendify:function(a){var o
return o=moment(a).tz(t),n("timezone",t),r(o,o),e(o,moment(a)).toDate()}}}})
var toString$={}.toString
angular.module("ablsdk").service("crud",function(n,t,e,r,a,o){return function(u,i){var c,l,s,d,f,m,v,p,h,y,g,b,D,w,S,A,M,T
return c=u.split("@"),u=c[0],l={loading:!1},s={localStorage:{remove:function(n){},add:function(n){},update:function(n){},fetch:function(n){}},memory:{remove:function(n){return h(n)},add:function(n,t){return Array.prototype.push.call(p,n),"function"==typeof t?t(n):void 0},update:function(n,t){return"function"==typeof t?t(n):void 0},fetch:function(){return l.loading=!1}},backend:{remove:function(t){return n["delete"](u+"/"+t._id).success(function(){return h(t)})},update:function(t,e){return n.update(u+"/"+t._id,t).success(function(n){return l.loading=!1,"function"==typeof e?e(n):void 0})},add:function(t,r){return n.create(u,t).success(function(n){return e("backend-success",n),D(n),"function"==typeof r?r(n):void 0})},fetch:function(){return e("fetch",m(u),p.options),n.get(m(u),{params:p.options}).success(function(n,t,e){var r,a
return p.length=0,r=function(n){var t,r
return t=e()[n],null!=t?(r=document.createElement("a"),r.href=e()[n],JSON.parse('{"'+decodeURI(r.search.substr(1,2e3)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')):void 0},p.options.total=(a=r("x-last-page-url"),null!=a?parseInt(a.page)*parseInt(a.pageSize):n.length),p.options.pageSize=(a=r("x-first-page-url"),null!=a?parseInt(a.pageSize):n.length),l.loading=!1,D(n)})}}},d=s[null!=(f=c[1])?f:"backend"],m=function(n){var t
for(t in p.urlOptions)n=n.replace(":"+t,p.urlOptions[t])
return n},v=t.$new(),v.items=[],p=v.items,l.loading=!1,h=function(n){var t
return t=p.indexOf(n),t>-1?Array.prototype.splice.call(p,t,1):void 0},y=function(n,t){return null!=n._id?g(n,t):b(n,t)},g=function(n,t){return l.loading?void 0:d.update(n,t)},b=function(n,t){return l.loading?void 0:d.add(n,t)},D=function(n){var t
return t=function(){switch(!1){case"Array"!==toString$.call(n).slice(8,-1):return n
case"Array"!==toString$.call(n[u]).slice(8,-1):return n[u]
case"Object"!==toString$.call(n).slice(8,-1):return[n]
default:return[]}}(),Array.prototype.push.apply(p,t),l.loading=!1},p.options={},p.urlOptions={},w=function(n){if(!l.loading){switch(typeof n){case"Number":p.options.page=n,e("number",p.options,n)
break
case"Object":p.urlOptions=$.extend({},"function"==typeof n.$url?n.$url({},p.options.urlOptions):void 0),delete n.$url,p.options=$.extend({},n,p.options)}return l.loading=!0,e("final-options",p.options,n),d.fetch()}},w(i),S=function(){var n
if(!l.loading)return n=Array.prototype.splice.apply(p,arguments),n.forEach(d.remove)},A=function(n,t,e){var a,o
if(!l.loading)return a={title:"Deletion",content:"Are you that you want to delete this item?",ok:"Confirm",cancel:"Cancel"},r.show(r.confirm().title(null!=(o=null!=e?e.title:void 0)?o:a.title).content(null!=(o=null!=e?e.content:void 0)?o:a.content).ok(null!=(o=null!=e?e.ok:void 0)?o:a.ok).cancel(null!=(o=null!=e?e.cancel:void 0)?o:a.cancel).targetEvent(t)).then(function(){return d.remove(n)},function(){})},M=[],T=function(n){var t,e
return t=[],e=curry$(function(e,r){var a,o
return a=[],T(a),o=function(){var t
return t=Array.prototype[e].call(n,r),a.length=0,Array.prototype.push.apply(a,t)},t.push(o),o(),a}),n.loading=function(){return l.loading},n.toArray=function(){var t
return t=[],Array.prototype.push.apply(t,n),t},n.watch=function(e,r){var u
return u=function(){return a(function(){return t.forEach(function(n){return n()})})},null!=r?(M.push({array:r[e],func:u}),r.$watch(e,u,!0)):(M.push({array:e,func:u}),o.watch(e,u)),n},n.watch(n),["map","filter"].forEach(function(t){return n[t]=e(t)}),n.push=b,n.save=y,n.fetch=w,n.remove=A,n.splice=S,n.toArray=function(){return angular.copy(n)}},p.listen=function(n){return n.$on("$destroy",function(){var n,t,e,r,a=[]
for(n=0,e=(t=M).length;e>n;++n)r=t[n],a.push(o.unwatch(r.array,r.func))
return a}),p},T(p),p}})
var toString$={}.toString
angular.module("ablsdk").factory("debug",function(n){return function(t){var e
if(n)switch(toString$.call(t).slice(8,-1)){case"Function":return t()
default:return"undefined"!=typeof console&&null!==console&&null!=(e=console.log)?e.apply(console,arguments):void 0}}}),angular.module("ablsdk").service("formula",function(n,t){var e,r
return e=function(t,e){var r,a
return r=null!=(a=null!=e?e.charges:void 0)?a:[],function(n){var t
return null!=(t=null!=n?n.amount:void 0)?t:0}(n.find(function(n){return n.type===t||n.subtype===t||n.description===t})(r))},r=function(t){var e,r,a,o,u,i,c,l
return(null!=t&&null!=(e=t.timeslots)?e.length:void 0)>0?(r=function(n){return[].concat.apply([],n)},a=function(t){var e,r
return e="Adult",n.map(function(n){return n.amount})(n.filter(function(n){return"active"===n.status})(n.filter(function(n){return n.type===e||n.subtype===e||n.description===e})(null!=(r=null!=t?t.charges:void 0)?r:[])))},o=function(t){var e
return n.map(function(n){return n.amount})(null!=(e=null!=t?t.charges:void 0)?e:[])},u=r(t.timeslots.map(a)),i=r(t.timeslots.map(o)),c=function(n){return Math.max.apply(Math,n)},l=function(){switch(!1){case!(u.length>0):return c(u)
case!(i.length>0):return c(i)
default:return 0}}()):"Non"},{getSlotPrice:function(n){return e("Adult",n)},getVisualPrice:r,getAdultPrice:function(n){var t
return e("Adult",null!=n&&null!=(t=n.timeslots)?t[0]:void 0)},getYouthPrice:function(n){var t
return e("Youth",null!=n&&null!=(t=n.timeslots)?t[0]:void 0)}}}),angular.module("ablsdk").filter("mdate",function(n){return function(n,t){return null!=n?n.format(t):null}}),angular.module("ablsdk").service("p",function(){var n
return{head:n=function(n){return n[0]},each:curry$(function(n,t){var e,r,a
for(e=0,r=t.length;r>e;++e)a=t[e],n(a)
return t}),map:curry$(function(n,t){var e,r,a,o=[]
for(e=0,r=t.length;r>e;++e)a=t[e],o.push(n(a))
return o}),filter:curry$(function(n,t){var e,r,a,o=[]
for(e=0,r=t.length;r>e;++e)a=t[e],n(a)&&o.push(a)
return o}),find:curry$(function(n,t){var e,r,a
for(e=0,r=t.length;r>e;++e)if(a=t[e],n(a))return a}),pairsToObj:function(n){var t,e,r,a={}
for(t=0,e=n.length;e>t;++t)r=n[t],a[r[0]]=r[1]
return a},objToPairs:function(n){var t,e,r=[]
for(t in n)e=n[t],r.push([t,e])
return r},values:function(n){var t,e,r=[]
for(t in n)e=n[t],r.push(e)
return r},any:curry$(function(n,t){var e,r,a
for(e=0,r=t.length;r>e;++e)if(a=t[e],n(a))return!0
return!1}),notAny:curry$(function(n,t){var e,r,a
for(e=0,r=t.length;r>e;++e)if(a=t[e],n(a))return!1
return!0}),sum:function(n){var t,e,r,a
for(t=0,e=0,r=n.length;r>e;++e)a=n[e],t+=a
return t},sort:function(n){return n.concat().sort(function(n,t){return n>t?1:t>n?-1:0})},sortWith:curry$(function(n,t){return t.concat().sort(n)}),sortBy:curry$(function(n,t){return t.concat().sort(function(t,e){return n(t)>n(e)?1:n(t)<n(e)?-1:0})}),reverse:function(n){return n.concat().reverse()}}}),angular.module("ablsdk").service("safeApply",function(n){return function(t){var e
return e=n.$$phase,"$apply"===e||"$digest"===e?t():n.$apply(t)}}),angular.module("ablsdk").service("ablslot",function(abldate,ablcalc,ablapi,formula,p,debug,$xabl){return function(activity,inputModel){var transformCharge,getDay,newDate,generateCalendar,getMonth,hackDate,merge,makeAvailable,performChooseSlot,actualEvent,isEmpty,slotsByDay,select,isFitToSlot,isNotFitToAnySlot,inPast,createMonth,startMonth,setCalendars,scroll,nextMonth,calendar,loadEvents,isDummy,isDisabledDay,selectDay,notSelected,disabledSlot,notAvailableSlot,close,chooseSlot,isActiveDay,isDisabledMonth,isActiveMonth,isCalendarUpDisabled,calendarUp,calendarDown,setup,move,createEventInstanceId,model,slots,calendars,activeSlots,x$,ref$
return transformCharge=function(n){return{_id:n._id,name:n.name,quantity:0,amount:n.amount}},getDay=function(n){var t
return null!=n?(t=null!=(null!=n?n.format:void 0)?n:moment(n),parseInt(t.format("YYYYMMDD"))):null},newDate=function(){var n
return n=moment.apply(null,arguments).tz(activity.timeZone)},generateCalendar=function(n,t){var e,r,a,o,u,i,c,l
return e=newDate(n),r=e.year(),a=e.month(),o=function(n){return newDate([r,a,n])},u=e.endOf("month").date(),i=p.map(o)(function(){var n,t,e=[]
for(n=1,t=u;t>=n;++n)e.push(n)
return e}()),c=newDate(i[0]).day(),l=p.map(function(){return null})(function(){var n,t,e=[]
for(n=1,t=c;t>=n;++n)e.push(n)
return e}()),{time:e,days:l.concat(i),headers:["Su","M","Tu","W","Th","F","Sa"]}},getMonth=function(n){return Math.ceil(getDay(n)/100)},hackDate=function(n,t){var e,r
return e=bind$(moment(n),"format"),r=bind$(t,"format"),moment(e("YYYY-MM-DD HH:mm ")+r("Z"),"YYYY-MM-DD HH:mm Z")},merge=function(n,t){var e,r
return e=null!=n?n:hackDate(n,moment()),r=null!=t?t:hackDate(t,moment()),moment([e.year(),e.month(),e.date(),r.hours(),r.minutes(),0])},makeAvailable=curry$(function(slot,arg){var available
return available=slot.available-eval([0].concat(model.calc.attendees.map(function(n){return n.quantity})).join("+"))}),performChooseSlot=function(n){var t,e,r,a,o
if(0!==n.available)return t=model.value,e=merge(t,n.startTime),model.date.start=e,r=abldate(activity.timeZone),model.date.origin=r.backendify(model.date.start).replace(/[\:-]/gi,""),model.date.end=n.endTime,model.charges=n.charges,model.calc=ablcalc(n.charges.concat(activity.charges)),model._id=n._id,model.eventId=activity.timeslots.filter(function(t){return t._id===n._id})[0].eventId,a=model.attendees,o=function(n){var t
return t=a.filter(function(t){return t.name===n.name}),{quantity:function(){switch(!1){case!(t.length>0):return t[0].quantity
case"Adult"!==n.name:return 1
default:return 0}}(),name:n.name,amount:n.amount}},model.attendees=n.charges.filter(function(n){return"aap"===n.type}).map(o),model.available=makeAvailable(n)},actualEvent=curry$(function(n,t){return getDay(t.startTime)===getDay(n)}),isEmpty=function(n){var t
return t=actualEvent(n),function(n){return 0===n.length}(p.filter(isFitToSlot(n))(slots))},slotsByDay=function(n){var t,e
return t=actualEvent(n),e=function(e){var r,a,o,u,i
return r=merge(n,e.startTime),a=e.endTime-e.startTime,o=e.events.filter(t).map(function(n){return n.available}),u=null!=(i=o[0])?i:e.maxOcc,{startTime:r,time:r.valueOf(),endTime:r.clone().add(a,"milliseconds"),charges:e.charges,price:formula.getVisualPrice({timeslots:[e]}),available:u,_id:e._id,duration:moment.duration(a).format("M[M] d[d] h[h] m[m]").replace(/((^| )0[a-z])|[ ]/gi,""),taken:e.maxOcc-u}},p.sortBy(function(n){return n.time})(p.map(e)(p.filter(isFitToSlot(n))(slots)))},select=function(n){return model.value=n,activeSlots.length=0,slotsByDay(n).forEach(function(n){return activeSlots.push(n)})},isFitToSlot=curry$(function(n,t){var e,r,a,o,u,i
return e=0===t.daysRunning.length,r=activity,a=function(){switch(!1){case!(getDay(t.startTime)!==getDay(n)&&e):return!0
case!(getDay(t.startTime)>getDay(n)&&!e):return!0
case!(getDay(t.untilTime)<getDay(n)&&!e):return!0
default:return!1}}(),o=function(n){var t,e
return t=null!=n&&"function"==typeof n.day?n.day():void 0,e=function(){switch(!1){case null!==t:return null
case 0!==t:return 6
default:return t-1}}()},u=!e&&p.notAny(function(t){return t===o(n)})(t.daysRunning),i=function(){switch(!1){case!u:return!1
case!a:return!1
default:return!0}}()}),isNotFitToAnySlot=function(n){switch(!1){case!p.notAny(function(n){return n.available>0})(slotsByDay(n)):return!0
case!p.notAny(isFitToSlot(n))(slots):return!0
default:return!1}},inPast=function(n){return getDay(n)<getDay(newDate())||n.diff(newDate(),"hours")<24},createMonth=function(n){return newDate([n.year(),n.month(),15])},startMonth=createMonth(newDate()),setCalendars=function(n,t,e){return calendars.length=0,calendars.push(n),calendars.push(t),loadEvents(e)},scroll={activeDate:function(){var n,t,e,r,a,o
return scroll.activeDate=function(){},n=calendars[0],t=function(t){return generateCalendar(n.time.clone().add(t,"month"))},e=function(e){return 0===e?n:t(e)},r=function(n){return"undefined"!=typeof e(n).days.find(function(n){return!isDisabledDay(n)})},a=function(n){return function(){var t,e,r=[]
for(t=1,e=n;e>=t;++t)r.push(t)
return r}().forEach(bind$(calendar,"down"))},o=[0,1,2,3,4,5,6].find(r),o>0?a(o):void 0}},nextMonth=function(n,t){return date.clone().add(t,"months")},calendar={first:startMonth,second:startMonth.clone().add(1,"months"),move:function(n){return calendar.first=calendar.first.clone().add(n,"month"),calendar.second=calendar.second.clone().add(n,"month"),setCalendars(generateCalendar(calendar.first),generateCalendar(calendar.second))},down:function(){return calendar.move(1)},up:function(){return calendar.move(-1)}},loadEvents=function(n){return ablapi.timeslots({startTime:calendars[0].time,endTime:calendars[1].time,activityId:activity._id}).success(function(t){var e,r,a
return e=abldate(activity.timeZone),r=compose$(e.frontendify,moment),a=function(n){return n.startTime=r(n.startTime),n.endTime=r(n.endTime),n.untilTime=r(n.untilTime),n},slots.length=0,t.timeslots.map(a).forEach(function(n){return slots.push(n)}),scroll.activeDate(),"function"==typeof n?n():void 0})},isDummy=function(n){switch(!1){case null!==n:return!0
default:return!1}},isDisabledDay=function(n){switch(!1){case!isDummy(n):return!0
case!isEmpty(n):return!0
case!inPast(n):return!0
case!isNotFitToAnySlot(n):return!0
default:return!1}},selectDay=function(n){return isDisabledDay(n)?void 0:(select(n),performChooseSlot(slots[0]))},notSelected=function(){switch(!1){case null!==model.date.start:return!0
case model.chosen!==!1:return!0
default:return!1}},disabledSlot=function(n){switch(!1){case 0!==n.available:return"This event is full"
default:return""}},notAvailableSlot=function(n){return n.available<=0},close=function(n){var t,e
return t=function(n){return 0===n.quantity&&"Adult"===n.name?n.quantity=1:void 0},e=model,e.attendees.forEach(t),e.chosen=n,e.visible=!1,"function"==typeof model.closed?model.closed(n):void 0},chooseSlot=function(n){return notAvailableSlot(n)?void 0:(performChooseSlot(n),close(!0))},isActiveDay=function(n){return getDay(n)===getDay(model.value)},isDisabledMonth=function(n){switch(!1){case!(getDay(n)<getDay(newDate())):return!0
default:return!1}},isActiveMonth=function(n){return getMonth(n)===getMonth(model.value)},isCalendarUpDisabled=function(){return getMonth(calendars[0].time)<getMonth(newDate())},calendarUp=function(){return isCalendarUpDisabled()?void 0:calendar.up()},calendarDown=function(){return calendar.down()},setup=function(){return setCalendars(generateCalendar(startMonth.clone()),generateCalendar(startMonth.clone().add(1,"month")),function(){return selectDay(model.value)})},move=function(n){return $xabl.put("bookings/move/"+n,{eventInstanceId:createEventInstanceId()})},createEventInstanceId=function(){var n
return n=abldate(activity.timeZone),model.eventId+"_"+n.backendify(model.date.start).replace(/[\:-]/gi,"")},model=null!=inputModel?inputModel:{},slots=[],calendars=[],activeSlots=[],x$=model,x$.date={start:null,end:null},x$.value=null,x$.eventId=null,x$.charges=[],x$.attendees=[],x$.addons=activity.charges.filter(function(n){return"addon"===n.type}).map(transformCharge),x$.questions=null!=(ref$=activity.questions)?ref$:[],x$.bg=activity.image,setup(),{model:model,activeSlots:activeSlots,move:move,selectDay:selectDay,calendars:calendars,createEventInstanceId:createEventInstanceId,calendarUp:calendarUp,calendarDown:calendarDown,close:close,isActiveMonth:isActiveMonth,isDisabledDay:isDisabledDay,isDisabledMonth:isDisabledMonth,isCalendarUpDisabled:isCalendarUpDisabled,isDummy:isDummy,isActiveDay:isActiveDay,notSelected:notSelected,chooseSlot:chooseSlot,notAvailableSlot:notAvailableSlot,disabledSlot:disabledSlot}}}),angular.module("ablsdk").service("watcher",function(n,t,e){var r,a,o
return r=function(){return{unwatch:function(n,t){return"function"==typeof t.unwatch?t.unwatch():void 0},watch:function(t,e){var r
return r=n.$new(),r.array=t,e.unwatch=r.$watch("array",e,!0)}}},a=function(){return{unwatch:function(n,t){return Array.unobserve(n,t)},watch:function(t,e){var r,a,o
return r=function(){var t
return t=n.$new(),function(n,e){return t.array=n,t.$watch("array",e)}},(a=null!=(o=Array.observe)?o:r())(t,e)}}},o=function(){switch(!1){case"firefox"!==t.name:return r()
case"unknown"!==t.name:return r()
case"safari"!==t.name:return r()
default:return r()}}()})
